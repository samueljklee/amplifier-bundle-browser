name: visual-audit
description: |
  Capture screenshots of a website across multiple pages for visual documentation,
  QA review, or change tracking.

# Usage:
#   amplifier tool invoke recipes operation=execute \
#     recipe_path=@browser:recipes/visual-audit.yaml \
#     context='{"base_url": "https://example.com", "pages": ["/", "/pricing", "/features"]}'

inputs:
  base_url:
    description: Base URL of the website to audit
    type: string
    required: true
  pages:
    description: List of page paths to capture (relative to base_url)
    type: array
    default: ["/"]
  output_dir:
    description: Directory to save screenshots
    type: string
    default: "./screenshots"

steps:
  - id: capture
    agent: browser:visual-documenter
    prompt: |
      Perform a visual audit of {{base_url}}
      
      Pages to capture:
      {{pages}}
      
      For each page:
      1. Navigate to {{base_url}}{page}
      2. Wait for full page load
      3. Take a screenshot named: {sanitized-page-name}.png
      4. Note any visual issues or anomalies
      
      After all captures:
      - List all screenshots taken with their file paths
      - Note any pages that failed to load
      - Report any visual inconsistencies observed
      
      Close the browser when complete.

  - id: report
    agent: foundation:explorer
    prompt: |
      Based on the visual audit results:
      
      {{steps.capture.result}}
      
      Create a visual audit report:
      
      ## Screenshots Captured
      | Page | Screenshot | Status |
      |------|------------|--------|
      [List each page and its screenshot]
      
      ## Visual Issues Found
      [Any anomalies or issues noted]
      
      ## Recommendations
      [Suggestions for improvement if any issues found]
      
      ## Next Steps
      [What to do with these screenshots]

output:
  format: markdown
  include:
    - steps.capture.result
    - steps.report.result
